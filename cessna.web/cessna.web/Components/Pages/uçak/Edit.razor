@page "/ucak/edit/{id:int}"
@rendermode InteractiveServer

@using cessna.web.Models
@using Microsoft.EntityFrameworkCore
@inject CessnasContext Db
@inject NavigationManager Nav

<h3>Edit Aircraft</h3>

@if (!string.IsNullOrEmpty(Hata))
{
    <div class="alert alert-danger">@Hata</div>
}

@if (ModelEntity == null)
{
    <p>Loading...</p>
}
else
{
    <input class="form-control mb-2" @bind="ModelEntity.KuyrukNo" />
    <input class="form-control mb-2" @bind="ModelEntity.Model" />
    <input class="form-control mb-2" @bind="ModelEntity.Uretici" />
    <input type="number" class="form-control mb-2" @bind="ModelEntity.Kapasite" />
    <input type="number" class="form-control mb-2" @bind="ModelEntity.UretimYili" />

    <button type="button" class="btn btn-primary" @onclick="Save">Save</button>
    <a class="btn btn-secondary ms-2" href="/ucak">Cancel</a>
}

@code {
    [Parameter] public int id { get; set; }
    Ucak? ModelEntity;
    string? Hata;

    protected override async Task OnInitializedAsync()
    {
        ModelEntity = await Db.Set<Ucak>()
                              .FirstOrDefaultAsync(x => x.UcakKod == id);

        if (ModelEntity == null)
            Hata = "Aircraft not found.";
    }

    void Save()
    {
        if (ModelEntity == null) return;
        Db.SaveChanges();
        Nav.NavigateTo("/ucak", forceLoad: true);
    }
}
